"""
ุณุงุฏูโุชุฑู ูุญุงุณุจู ุฏููพูุฑ โ ุจุฑุง ุชุณุช ุงููู
ูุณุฎู ฑ.ฐ - ูุฏู ุงูู ูพุฑูฺู
"""

def doppler_classic(f_source, v_source, v_observer, c=343):
    """
    ุฏููพูุฑ ฺฉูุงุณฺฉ ุจุฑุง ุตูุช ุฏุฑ ููุง (ุณุฑุนุช ุตูุช = 343 m/s)
    
    ูพุงุฑุงูุชุฑูุง:
    ----------
    f_source : float
        ูุฑฺฉุงูุณ ุณุงุทุนโุดุฏู ุงุฒ ููุจุน (ูุฑุชุฒ)
    v_source : float
        ุณุฑุนุช ููุจุน (ูุชุฑ ุจุฑ ุซุงูู). ูุซุจุช ุงฺฏุฑ ุจู ุณูุช ูุงุธุฑ ุญุฑฺฉุช ฺฉูุฏ
    v_observer : float
        ุณุฑุนุช ูุงุธุฑ (ูุชุฑ ุจุฑ ุซุงูู). ูุซุจุช ุงฺฏุฑ ุจู ุณุงุจุช ููุจุน ุญุฑฺฉุช ฺฉูุฏ
    c : float, optional
        ุณุฑุนุช ุตูุช ุฏุฑ ูุญุท (ูพุดโูุฑุถ: 343 m/s ุจุฑุง ููุง)
    
    ุจุงุฒูโฺฏุฑุฏุงูุฏ:
    -----------
    float : ูุฑฺฉุงูุณ ูุดุงูุฏูโุดุฏู ุชูุณุท ูุงุธุฑ (ูุฑุชุฒ)
    """
    return f_source * (c + v_observer) / (c - v_source)


def test_scenario_1():
    """ุชุณุช ูุถุนุช ฑ: ููุจุน ุซุงุจุชุ ูุงุธุฑ ุจู ุณูุช ููุจุน ุญุฑฺฉุช ูโฺฉูุฏ"""
    print("\n๐งช ุชุณุช ฑ: ููุจุน ุซุงุจุชุ ูุงุธุฑ ูุชุญุฑฺฉ")
    print("-" * 40)
    
    f0 = 440  # ูุช ูุง (ูุฑุชุฒ)
    v_source = 0    # ููุจุน ุซุงุจุช
    v_observer = 30 # ูุงุธุฑ ุจุง ุณุฑุนุช 30 m/s ุจู ุณูุช ููุจุน ูโุฑูุฏ
    
    f_obs = doppler_classic(f0, v_source, v_observer)
    
    print(f"ูุฑฺฉุงูุณ ููุจุน:     {f0} Hz")
    print(f"ุณุฑุนุช ููุจุน:       {v_source} m/s")
    print(f"ุณุฑุนุช ูุงุธุฑ:       {v_observer} m/s (ุจู ุณูุช ููุจุน)")
    print(f"ูุฑฺฉุงูุณ ูุดุงูุฏู:   {f_obs:.1f} Hz")
    print(f"ุชุบุฑ:           {((f_obs - f0) / f0 * 100):+.2f}%")
    
    # ูุญุงุณุจู ุฏุณุช ุจุฑุง ุชุฃุฏ
    expected = 440 * (343 + 30) / 343
    tolerance = 0.1
    
    if abs(f_obs - expected) < tolerance:
        print(f"โ ุชุณุช ฑ ฺฏุฐุดุช (ุฎุทุง: {abs(f_obs - expected):.4f})")
        return True
    else:
        print(f"โ ุชุณุช ฑ ุดฺฉุณุช ุฎูุฑุฏ (ุงุฎุชูุงู: {abs(f_obs - expected):.4f})")
        return False


def test_scenario_2():
    """ุชุณุช ูุถุนุช ฒ: ููุจุน ุงุฒ ูุงุธุฑ ุฏูุฑ ูโุดูุฏุ ูุงุธุฑ ุซุงุจุช"""
    print("\n๐งช ุชุณุช ฒ: ููุจุน ูุชุญุฑฺฉุ ูุงุธุฑ ุซุงุจุช")
    print("-" * 40)
    
    f0 = 440  # ูุช ูุง (ูุฑุชุฒ)
    v_source = 30   # ููุจุน ุจุง ุณุฑุนุช 30 m/s ุงุฒ ูุงุธุฑ ุฏูุฑ ูโุดูุฏ
    v_observer = 0  # ูุงุธุฑ ุซุงุจุช
    
    f_obs = doppler_classic(f0, v_source, v_observer)
    
    print(f"ูุฑฺฉุงูุณ ููุจุน:     {f0} Hz")
    print(f"ุณุฑุนุช ููุจุน:       {v_source} m/s (ุฏูุฑ ุงุฒ ูุงุธุฑ)")
    print(f"ุณุฑุนุช ูุงุธุฑ:       {v_observer} m/s")
    print(f"ูุฑฺฉุงูุณ ูุดุงูุฏู:   {f_obs:.1f} Hz")
    print(f"ุชุบุฑ:           {((f_obs - f0) / f0 * 100):+.2f}%")
    
    # ูุญุงุณุจู ุฏุณุช ุจุฑุง ุชุฃุฏ
    expected = 440 * 343 / (343 - 30)
    tolerance = 0.1
    
    if abs(f_obs - expected) < tolerance:
        print(f"โ ุชุณุช ฒ ฺฏุฐุดุช (ุฎุทุง: {abs(f_obs - expected):.4f})")
        return True
    else:
        print(f"โ ุชุณุช ฒ ุดฺฉุณุช ุฎูุฑุฏ (ุงุฎุชูุงู: {abs(f_obs - expected):.4f})")
        return False


def run_all_tests():
    """ุงุฌุฑุง ููู ุชุณุชโูุง"""
    print("=" * 50)
    print("๐ ุดุฑูุน ุชุณุชโูุง ุฏููพูุฑ ฺฉูุงุณฺฉ")
    print("=" * 50)
    
    test1_passed = test_scenario_1()
    test2_passed = test_scenario_2()
    
    print("\n" + "=" * 50)
    print("๐ ฺฏุฒุงุฑุด ููุง:")
    print(f"   ุชุณุช ฑ: {'โ ฺฏุฐุดุช' if test1_passed else 'โ ุดฺฉุณุช'}")
    print(f"   ุชุณุช ฒ: {'โ ฺฏุฐุดุช' if test2_passed else 'โ ุดฺฉุณุช'}")
    print(f"   ูุชุฌู ฺฉู: {'โ ููู ุชุณุชโูุง ฺฏุฐุดุชูุฏ' if test1_passed and test2_passed else 'โ ุจุฑุฎ ุชุณุชโูุง ุดฺฉุณุช ุฎูุฑุฏูุฏ'}")
    print("=" * 50)
    
    return test1_passed and test2_passed


if __name__ == "__main__":
    # ููุช ูุงู ูุณุชููุงู ุงุฌุฑุง ุดูุฏ
    success = run_all_tests()
    
    # ุฐุฎุฑู ูุชุฌู ุฏุฑ ูุงู
    with open("test_result.txt", "w", encoding="utf-8") as f:
        f.write(f"ุชุณุช ุฏููพูุฑ ฺฉูุงุณฺฉ - {success}\n")
        f.write(f"ุชุงุฑุฎ: {__import__('datetime').datetime.now()}\n")
    
    if success:
        print("\n๐ ููู ุชุณุชโูุง ููููุชโุขูุฒ ุจูุฏูุฏ!")
        print("๐ ูุชุฌู ุฏุฑ ูุงู 'test_result.txt' ุฐุฎุฑู ุดุฏ")
    else:
        print("\nโ๏ธ ุจุฑุฎ ุชุณุชโูุง ุดฺฉุณุช ุฎูุฑุฏูุฏ. ูุงุฒ ุจู ุจุฑุฑุณ ุฏุงุฑุฏ.")
    
    print("\nุจุฑุง ุฎุฑูุฌุ Enter ุจุฒูุฏ...")
    input()